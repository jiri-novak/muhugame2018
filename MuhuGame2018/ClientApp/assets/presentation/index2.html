<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.7.0/dist/Chart.min.js"></script>
    <script src="js/chartjs-plugin-datalabels.js"></script>
    <script src="js/utils.js"></script>
</head>

<body>
    <div id="charts">
        <div class="wrapper"><canvas id="chart-0"></canvas></div>
    </div>

    <script id="script-init">
        var DATA_COUNT = 10;
        var labels = [];

        Samples.srand(2);

        for (var i = 0; i < DATA_COUNT; ++i) {
            labels.push('' + i);
        }

        Chart.helpers.merge(Chart.defaults.global, {
            aspectRatio: 4 / 3,
            tooltips: false,
            layout: {
                padding: {
                    top: 42,
                    right: 16,
                    bottom: 32,
                    left: 8
                }
            },
            elements: {
                line: {
                    fill: false
                },
                point: {
                    hoverRadius: 7,
                    radius: 5
                }
            },
            plugins: {
                legend: false,
                title: false
            }
        });
    </script>

    <script id="script-construct">
        var chart = new Chart('chart-0', {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    backgroundColor: Samples.color(0),
                    data: Samples.numbers({
                        count: DATA_COUNT,
                        min: 0,
                        max: 100
                    }),
                    datalabels: {
                        align: 'end',
                        anchor: 'start'
                    }
                }, {
                    backgroundColor: Samples.color(1),
                    data: Samples.numbers({
                        count: DATA_COUNT,
                        min: 0,
                        max: 100
                    }),
                    datalabels: {
                        align: 'center',
                        anchor: 'center'
                    }
                }, {
                    backgroundColor: Samples.color(2),
                    data: Samples.numbers({
                        count: DATA_COUNT,
                        min: 0,
                        max: 100
                    }),
                    datalabels: {
                        anchor: 'end',
                        align: 'start',
                    }
                }]
            },
            options: {
                plugins: {
                    datalabels: {
                        color: 'white',
                        display: function (context) {
                            return context.dataset.data[context.dataIndex] > 15;
                        },
                        font: {
                            weight: 'bold'
                        },
                        formatter: Math.round
                    }
                },
                scales: {
                    xAxes: [{
                        stacked: true
                    }],
                    yAxes: [{
                        stacked: true
                    }]
                }
            }
        });
    </script>
</body>

</html>